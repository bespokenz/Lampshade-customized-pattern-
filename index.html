<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Design and create custom lampshade patterns">
    <meta name="theme-color" content="#2563eb">
    <title>Lampshade Pattern Designer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #2563eb;
            --secondary-color: #dc2626;
            --success-color: #16a34a;
            --purple-color: #9333ea;
            --bg-gradient-start: #eff6ff;
            --bg-gradient-end: #e0e7ff;
            --text-dark: #1f2937;
            --text-light: #6b7280;
            --border-color: #e5e7eb;
            --card-bg: #ffffff;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, var(--bg-gradient-start), var(--bg-gradient-end));
            min-height: 100vh;
            color: var(--text-dark);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .header {
            background: var(--card-bg);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            padding: 2rem 0;
            margin-bottom: 2rem;
        }

        .header h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            color: var(--text-light);
            font-size: 1rem;
        }

        .grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        @media (min-width: 768px) {
            .grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        .card {
            background: var(--card-bg);
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .card h2 {
            font-size: 1.25rem;
            margin-bottom: 1.5rem;
            color: var(--text-dark);
        }

        .card h3 {
            font-size: 1rem;
            margin-bottom: 0.75rem;
            color: var(--text-dark);
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: var(--text-dark);
        }

        .form-group input[type="number"] {
            width: 100%;
            padding: 0.5rem 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 0.375rem;
            font-size: 1rem;
            transition: all 0.2s;
        }

        .form-group input[type="number"]:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .checkbox-group label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
        }

        .checkbox-group input[type="checkbox"] {
            width: 1rem;
            height: 1rem;
            cursor: pointer;
        }

        .button-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
            margin-top: 1.5rem;
        }

        .btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            color: white;
        }

        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.2);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-primary { background-color: var(--primary-color); }
        .btn-primary:hover { background-color: #1d4ed8; }
        .btn-secondary { background-color: var(--secondary-color); }
        .btn-secondary:hover { background-color: #b91c1c; }
        .btn-success { background-color: var(--success-color); }
        .btn-success:hover { background-color: #15803d; }
        .btn-purple { background-color: var(--purple-color); }
        .btn-purple:hover { background-color: #7e22ce; }
        .btn-sm { padding: 0.375rem 0.75rem; font-size: 0.875rem; }
        .btn-danger { background-color: var(--secondary-color); }
        .btn-danger:hover { background-color: #b91c1c; }

        canvas {
            width: 100%;
            height: auto;
            border: 1px solid var(--border-color);
            border-radius: 0.375rem;
            background: white;
        }

        .info-box {
            margin-top: 1rem;
            padding: 1rem;
            background: #eff6ff;
            border-radius: 0.375rem;
        }

        .info-box h3 {
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .info-box p {
            font-size: 0.875rem;
            color: var(--text-light);
            margin-bottom: 0.25rem;
        }

        .patterns-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
        }

        @media (min-width: 768px) {
            .patterns-grid { grid-template-columns: repeat(2, 1fr); }
        }

        @media (min-width: 1024px) {
            .patterns-grid { grid-template-columns: repeat(3, 1fr); }
        }

        .pattern-card {
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            padding: 1rem;
            background: white;
        }

        .pattern-card h3 {
            font-size: 1rem;
            margin-bottom: 0.75rem;
            color: var(--text-dark);
        }

        .pattern-details p {
            font-size: 0.875rem;
            color: var(--text-light);
            margin-bottom: 0.25rem;
        }

        .pattern-date {
            font-size: 0.75rem;
            color: #9ca3af;
            margin-top: 0.5rem;
        }

        .pattern-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.75rem;
        }

        .pattern-actions .btn { flex: 1; }

        .instructions {
            padding-left: 1.5rem;
            margin-bottom: 1rem;
        }

        .instructions li {
            margin-bottom: 0.5rem;
            color: var(--text-light);
        }

        .note {
            font-size: 0.875rem;
            color: var(--text-light);
            padding: 1rem;
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            border-radius: 0.375rem;
            margin-top: 1rem;
        }

        .note strong { color: var(--text-dark); }

        .footer {
            background: var(--card-bg);
            padding: 2rem 0;
            margin-top: 3rem;
            text-align: center;
            color: var(--text-light);
            font-size: 0.875rem;
        }

        @media print {
            body { background: white; }
            .header, .footer, .button-grid, .card h2, .info-box, #savedPatternsSection, .instructions { display: none; }
            .card { box-shadow: none; padding: 0; page-break-inside: avoid; }
            canvas { border: none; max-width: 100%; page-break-inside: avoid; }
        }

        @media (max-width: 767px) {
            .header h1 { font-size: 1.5rem; }
            .button-grid { grid-template-columns: 1fr; }
            .container { padding: 0 0.75rem; }
        }

        html { scroll-behavior: smooth; }
        *:focus-visible { outline: 2px solid var(--primary-color); outline-offset: 2px; }
    </style>
</head>
<body>
    <div id="app">
        <header class="header">
            <div class="container">
                <h1>üèÆ Lampshade Pattern Designer</h1>
                <p class="subtitle">Design and create custom lampshade patterns</p>
            </div>
        </header>

        <main class="container">
            <div class="grid">
                <div class="card">
                    <h2>Design Parameters</h2>
                    
                    <div class="form-group">
                        <label for="topDiameter">Top Diameter (mm)</label>
                        <input type="number" id="topDiameter" value="200" min="50" max="1000">
                    </div>

                    <div class="form-group">
                        <label for="bottomDiameter">Bottom Diameter (mm)</label>
                        <input type="number" id="bottomDiameter" value="300" min="50" max="1000">
                    </div>

                    <div class="form-group">
                        <label for="height">Height (mm)</label>
                        <input type="number" id="height" value="200" min="50" max="1000">
                    </div>

                    <div class="form-group">
                        <label for="seamAllowance">Seam Allowance (mm)</label>
                        <input type="number" id="seamAllowance" value="15" min="0" max="50">
                    </div>

                    <div class="form-group checkbox-group">
                        <label>
                            <input type="checkbox" id="kissCut">
                            <span>Add Kiss Cut</span>
                        </label>
                    </div>

                    <div class="form-group">
                        <label for="pageMargin">Page Margin (mm)</label>
                        <input type="number" id="pageMargin" value="10" min="5" max="50">
                    </div>

                    <div class="button-grid">
                        <button id="downloadSVG" class="btn btn-primary">üì• Download SVG</button>
                        <button id="downloadPDF" class="btn btn-secondary">üìÑ Download PDF</button>
                        <button id="savePattern" class="btn btn-success">üíæ Save Pattern</button>
                        <button id="printPattern" class="btn btn-purple">üñ®Ô∏è Print</button>
                    </div>
                </div>

                <div class="card">
                    <h2>Pattern Preview</h2>
                    <canvas id="canvas" width="600" height="400"></canvas>
                    
                    <div class="info-box">
                        <h3>Pattern Information</h3>
                        <div id="patternInfo"></div>
                    </div>
                </div>
            </div>

            <div id="savedPatternsSection" class="card" style="display: none;">
                <h2>Saved Patterns</h2>
                <div id="savedPatternsList" class="patterns-grid"></div>
            </div>

            <div class="card">
                <h2>How to Use</h2>
                <ol class="instructions">
                    <li>Enter your lampshade dimensions (top diameter, bottom diameter, and height)</li>
                    <li>Add a seam allowance if needed (typically 15mm)</li>
                    <li>Preview your pattern in real-time</li>
                    <li>Download as SVG or PDF for printing</li>
                    <li>Save patterns for future reference</li>
                    <li>Print directly from the browser</li>
                </ol>
                <p class="note">
                    <strong>Note:</strong> For patterns larger than A4, use the PDF poster printing option 
                    to split across multiple pages. Most PDF readers have a "Poster" option in print settings.
                </p>
            </div>
        </main>

        <footer class="footer">
            <div class="container">
                <p>&copy; 2024 Lampshade Pattern Designer. Free Tool.</p>
            </div>
        </footer>
    </div>

    <script>
        // Get DOM elements
        const topDiameterInput = document.getElementById('topDiameter');
        const bottomDiameterInput = document.getElementById('bottomDiameter');
        const heightInput = document.getElementById('height');
        const seamAllowanceInput = document.getElementById('seamAllowance');
        const kissCutInput = document.getElementById('kissCut');
        const pageMarginInput = document.getElementById('pageMargin');
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        const downloadSVGBtn = document.getElementById('downloadSVG');
        const downloadPDFBtn = document.getElementById('downloadPDF');
        const savePatternBtn = document.getElementById('savePattern');
        const printPatternBtn = document.getElementById('printPattern');

        const patternInfoDiv = document.getElementById('patternInfo');
        const savedPatternsSection = document.getElementById('savedPatternsSection');
        const savedPatternsList = document.getElementById('savedPatternsList');

        function calculatePattern() {
            const topDiameter = parseFloat(topDiameterInput.value);
            const bottomDiameter = parseFloat(bottomDiameterInput.value);
            const height = parseFloat(heightInput.value);
            
            const r1 = topDiameter / 2;
            const r2 = bottomDiameter / 2;
            const h = height;
            
            const slantHeight = Math.sqrt(h * h + (r2 - r1) * (r2 - r1));
            const R1 = (r1 * slantHeight) / (r2 - r1);
            const R2 = R1 + slantHeight;
            const arcAngle = (2 * Math.PI * r2) / R2;
            
            return {
                r1, r2, h, slantHeight, R1, R2, arcAngle,
                arcAngleDegrees: (arcAngle * 180) / Math.PI,
                topDiameter, bottomDiameter, height
            };
        }

        function drawPattern() {
            const pattern = calculatePattern();
            const seamAllowance = parseFloat(seamAllowanceInput.value);
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            const scale = 1.5;
            const centerX = canvas.width / 2;
            const centerY = 50;
            
            ctx.save();
            ctx.translate(centerX, centerY);
            
            ctx.beginPath();
            ctx.strokeStyle = '#2563eb';
            ctx.lineWidth = 2;
            
            const startAngle = -pattern.arcAngle / 2;
            const endAngle = pattern.arcAngle / 2;
            
            ctx.arc(0, 0, pattern.R2 * scale, startAngle, endAngle);
            ctx.lineTo(Math.sin(endAngle) * pattern.R1 * scale, Math.cos(endAngle) * pattern.R1 * scale);
            ctx.arc(0, 0, pattern.R1 * scale, endAngle, startAngle, true);
            ctx.closePath();
            ctx.stroke();
            
            if (seamAllowance > 0) {
                ctx.beginPath();
                ctx.strokeStyle = '#dc2626';
                ctx.lineWidth = 1;
                ctx.setLineDash([5, 5]);
                
                const seamScale = seamAllowance / 10;
                
                ctx.moveTo(Math.sin(endAngle) * pattern.R2 * scale, Math.cos(endAngle) * pattern.R2 * scale);
                ctx.lineTo(Math.sin(endAngle) * pattern.R2 * scale + seamScale * 10, Math.cos(endAngle) * pattern.R2 * scale);
                ctx.lineTo(Math.sin(endAngle) * pattern.R1 * scale + seamScale * 10, Math.cos(endAngle) * pattern.R1 * scale);
                ctx.lineTo(Math.sin(endAngle) * pattern.R1 * scale, Math.cos(endAngle) * pattern.R1 * scale);
                
                ctx.stroke();
                ctx.setLineDash([]);
            }
            
            ctx.fillStyle = '#1f2937';
            ctx.font = '12px Arial, sans-serif';
            ctx.fillText(`Top: ${pattern.topDiameter}mm`, -80, pattern.R1 * scale - 10);
            ctx.fillText(`Bottom: ${pattern.bottomDiameter}mm`, -90, pattern.R2 * scale + 20);
            ctx.fillText(`Height: ${pattern.height}mm`, pattern.R2 * scale * 0.7, (pattern.R1 + pattern.R2) * scale / 2);
            
            ctx.restore();
            
            updatePatternInfo(pattern);
        }

        function updatePatternInfo(pattern) {
            const info = `
                <p><strong>Arc Angle:</strong> ${pattern.arcAngleDegrees.toFixed(2)}¬∞</p>
                <p><strong>Slant Height:</strong> ${pattern.slantHeight.toFixed(2)}mm</p>
                <p><strong>Top Circumference:</strong> ${(Math.PI * pattern.topDiameter).toFixed(2)}mm</p>
                <p><strong>Bottom Circumference:</strong> ${(Math.PI * pattern.bottomDiameter).toFixed(2)}mm</p>
            `;
            patternInfoDiv.innerHTML = info;
        }

        function generateSVG() {
            const pattern = calculatePattern();
            const seamAllowance = parseFloat(seamAllowanceInput.value);
            const pageMargin = parseFloat(pageMarginInput.value);
            const scale = 2;
            
            const width = pattern.R2 * 2 * scale + pageMargin * 2;
            const height = pattern.R2 * scale + pageMargin * 2;
            
            const startAngle = -pattern.arcAngle / 2;
            const endAngle = pattern.arcAngle / 2;
            
            const centerX = width / 2;
            const centerY = pageMargin;
            
            const outerStartX = centerX + Math.sin(startAngle) * pattern.R2 * scale;
            const outerStartY = centerY + Math.cos(startAngle) * pattern.R2 * scale;
            const outerEndX = centerX + Math.sin(endAngle) * pattern.R2 * scale;
            const outerEndY = centerY + Math.cos(endAngle) * pattern.R2 * scale;
            
            const innerStartX = centerX + Math.sin(startAngle) * pattern.R1 * scale;
            const innerStartY = centerY + Math.cos(startAngle) * pattern.R1 * scale;
            const innerEndX = centerX + Math.sin(endAngle) * pattern.R1 * scale;
            const innerEndY = centerY + Math.cos(endAngle) * pattern.R1 * scale;
            
            const largeArcFlag = pattern.arcAngle > Math.PI ? 1 : 0;
            
            let pathData = `M ${outerStartX} ${outerStartY} `;
            pathData += `A ${pattern.R2 * scale} ${pattern.R2 * scale} 0 ${largeArcFlag} 1 ${outerEndX} ${outerEndY} `;
            pathData += `L ${innerEndX} ${innerEndY} `;
            pathData += `A ${pattern.R1 * scale} ${pattern.R1 * scale} 0 ${largeArcFlag} 0 ${innerStartX} ${innerStartY} `;
            pathData += `Z`;
            
            let svg = `<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="${width}mm" height="${height}mm" viewBox="0 0 ${width} ${height}">
  <defs>
    <style>
      .pattern-line { fill: none; stroke: black; stroke-width: 0.5; }
      .seam-line { stroke: red; stroke-width: 0.3; stroke-dasharray: 2,2; }
      .text { font-family: Arial, sans-serif; font-size: 10px; fill: black; }
    </style>
  </defs>
  <g>
    <path class="pattern-line" d="${pathData}"/>`;
            
            if (seamAllowance > 0) {
                svg += `
    <line class="seam-line" x1="${outerEndX}" y1="${outerEndY}" x2="${outerEndX + seamAllowance * scale}" y2="${outerEndY}"/>
    <line class="seam-line" x1="${outerEndX + seamAllowance * scale}" y1="${outerEndY}" x2="${innerEndX + seamAllowance * scale}" y2="${innerEndY}"/>
    <line class="seam-line" x1="${innerEndX + seamAllowance * scale}" y1="${innerEndY}" x2="${innerEndX}" y2="${innerEndY}"/>`;
            }
            
            svg += `
    <text class="text" x="${centerX}" y="15" text-anchor="middle">
      Top: ${pattern.topDiameter}mm | Bottom: ${pattern.bottomDiameter}mm | Height: ${pattern.height}mm | Arc: ${pattern.arcAngleDegrees.toFixed(1)}¬∞
    </text>
  </g>
</svg>`;
            
            return svg;
        }

        function downloadSVG() {
            const svg = generateSVG();
            const blob = new Blob([svg], { type: 'image/svg+xml' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `lampshade-${topDiameterInput.value}x${bottomDiameterInput.value}x${heightInput.value}.svg`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function downloadPDF() {
            const svg = generateSVG();
            const blob = new Blob([svg], { type: 'application/pdf' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `lampshade-${topDiameterInput.value}x${bottomDiameterInput.value}x${heightInput.value}.pdf`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function savePattern() {
            const pattern = {
                id: Date.now(),
                name: `Pattern ${topDiameterInput.value}√ó${bottomDiameterInput.value}√ó${heightInput.value}`,
                topDiameter: parseFloat(topDiameterInput.value),
                bottomDiameter: parseFloat(bottomDiameterInput.value),
                height: parseFloat(heightInput.value),
                seamAllowance: parseFloat(seamAllowanceInput.value),
                kissCut: kissCutInput.checked,
                pageMargin: parseFloat(pageMarginInput.value),
                date: new Date().toLocaleString()
            };
            
            const saved = JSON.parse(localStorage.getItem('lampshadePatterns') || '[]');
            saved.push(pattern);
            localStorage.setItem('lampshadePatterns', JSON.stringify(saved));
            
            displaySavedPatterns();
            alert('Pattern saved successfully!');
        }

        function displaySavedPatterns() {
            const saved = JSON.parse(localStorage.getItem('lampshadePatterns') || '[]');
            
            if (saved.length === 0) {
                savedPatternsSection.style.display = 'none';
                return;
            }
            
            savedPatternsSection.style.display = 'block';
            savedPatternsList.innerHTML = '';
            
            saved.forEach(pattern => {
                const card = document.createElement('div');
                card.className = 'pattern-card';
                card.innerHTML = `
                    <h3>${pattern.name}</h3>
                    <div class="pattern-details">
                        <p><strong>Top:</strong> ${pattern.topDiameter}mm</p>
                        <p><strong>Bottom:</strong> ${pattern.bottomDiameter}mm</p>
                        <p><strong>Height:</strong> ${pattern.height}mm</p>
                        <p class="pattern-date">${pattern.date}</p>
                    </div>
                    <div class="pattern-actions">
                        <button class="btn btn-sm btn-primary" onclick="loadPattern(${pattern.id})">Load</button>
                        <button class="btn btn-sm btn-danger" onclick="deletePattern(${pattern.id})">Delete</button>
                    </div>
                `;
                savedPatternsList.appendChild(card);
            });
        }

        function loadPattern(id) {
            const saved = JSON.parse(localStorage.getItem('lampshadePatterns') || '[]');
            const pattern = saved.find(p => p.id === id);
            
            if (pattern) {
                topDiameterInput.value = pattern.topDiameter;
                bottomDiameterInput.value = pattern.bottomDiameter;
                heightInput.value = pattern.height;
                seamAllowanceInput.value = pattern.seamAllowance;
                kissCutInput.checked = pattern.kissCut;
                pageMarginInput.value = pattern.pageMargin;
                
                drawPattern();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function deletePattern(id) {
            if (confirm('Are you sure you want to delete this pattern?')) {
                const saved = JSON.parse(localStorage.getItem('lampshadePatterns') || '[]');
                const filtered = saved.filter(p => p.id !== id);
                localStorage.setItem('lampshadePatterns', JSON.stringify(filtered));
                displaySavedPatterns();
            }
        }

        function printPattern() {
            window.print();
        }

        window.loadPattern = loadPattern;
        window.deletePattern = deletePattern;

        topDiameterInput.addEventListener('input', drawPattern);
        bottomDiameterInput.addEventListener('input', drawPattern);
        heightInput.addEventListener('input', drawPattern);
        seamAllowanceInput.addEventListener('input', drawPattern);
        kissCutInput.addEventListener('change', drawPattern);
        pageMarginInput.addEventListener('input', drawPattern);

        downloadSVGBtn.addEventListener('click', downloadSVG);
        downloadPDFBtn.addEventListener('click', downloadPDF);
        savePatternBtn.addEventListener('click', savePattern);
        printPatternBtn.addEventListener('click', printPattern);

        drawPattern();
        displaySavedPatterns();
    </script>
</body>
</html>
